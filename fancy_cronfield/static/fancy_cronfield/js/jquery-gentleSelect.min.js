(function(c){function f(a){return"undefined"==typeof a?!1:!0}function q(a,b){return f(b.columns)&&f(b.rows)?(c.error("gentleSelect: You cannot supply both 'rows' and 'columns'"),!0):f(b.columns)&&!f(b.itemWidth)?(c.error("gentleSelect: itemWidth must be supplied if 'columns' is specified"),!0):f(b.rows)&&!f(b.itemWidth)?(c.error("gentleSelect: itemWidth must be supplied if 'rows' is specified"),!0):!f(b.openSpeed)||"number"!=typeof b.openSpeed&&"string"==typeof b.openSpeed&&"slow"!=b.openSpeed&&"fast"!=
b.openSpeed?(c.error('gentleSelect: openSpeed must be an integer or "slow" or "fast"'),!0):!f(b.closeSpeed)||"number"!=typeof b.closeSpeed&&"string"==typeof b.closeSpeed&&"slow"!=b.closeSpeed&&"fast"!=b.closeSpeed?(c.error('gentleSelect: closeSpeed must be an integer or "slow" or "fast"'),!0):!f(b.openEffect)||"fade"!=b.openEffect&&"slide"!=b.openEffect?(c.error("gentleSelect: openEffect must be either 'fade' or 'slide'!"),!0):!f(b.closeEffect)||"fade"!=b.closeEffect&&"slide"!=b.closeEffect?(c.error("gentleSelect: closeEffect must be either 'fade' or 'slide'!"),
!0):f(b.hideOnMouseOut)&&"boolean"==typeof b.hideOnMouseOut?!1:(c.error('gentleSelect: hideOnMouseOut must be supplied and either "true" or "false"!'),!0)}function r(a,b){a.attr("multiple")&&(b.hideOnMouseOut=!0)}function p(a,b){if(1>a.length)return b.prompt;if(0!=b.maxDisplay&&a.length>b.maxDisplay){var d=a.slice(0,b.maxDisplay).map(function(){return c(this).text()});d.push("...")}else d=a.map(function(){return c(this).text()});return d.get().join(", ")}var t={minWidth:100,itemWidth:void 0,columns:void 0,
rows:void 0,title:void 0,prompt:gettext("Make A Selection"),maxDisplay:0,openSpeed:400,closeSpeed:400,openEffect:"slide",closeEffect:"slide",hideOnMouseOut:!0},g={init:function(a){a=c.extend({},t,a);if(q(this,a))return this;r(this,a);this.hide();label_text=p(this.find(":selected"),a);var b=c("<span class='gentleselect-label'>"+label_text+"</span>").insertBefore(this).bind("mouseenter.gentleselect",k.labelHoverIn).bind("mouseleave.gentleselect",k.labelHoverOut).bind("click.gentleselect",k.labelClick).data("root",
this);this.data("label",b).data("options",a);var d=c("<ul></ul>");this.find("option").each(function(){var a=c("<li>"+c(this).text()+"</li>").data("value",c(this).attr("value")).data("name",c(this).text()).appendTo(d);c(this).attr("selected")&&a.addClass("selected")});b=c("<div class='gentleselect-dialog'></div>").append(d).insertAfter(b).bind("click.gentleselect",k.dialogClick).bind("mouseleave.gentleselect",k.dialogHoverOut).data("label",b).data("root",this);this.data("dialog",b);if(f(a.columns)||
f(a.rows)){d.css("float","left").find("li").width(a.itemWidth).css("float","left");var e=d.find("li:first"),h=a.itemWidth,h=h+parseInt(e.css("padding-left")),h=h+parseInt(e.css("padding-right")),e=d.find("li").length;if(f(a.columns))var m=parseInt(a.columns),l=Math.ceil(e/m);else l=parseInt(a.rows),m=Math.ceil(e/l);b.width(h*m);for(h=0;h<l*m-e;h++)c("<li style='float:left' class='gentleselect-dummy'><span>&nbsp;</span></li>").appendTo(d);var g=[],n=0;d.find("li").each(function(){if(n<l)g[n]=c(this);
else{var a=n%l;c(this).insertAfter(g[a]);g[a]=c(this)}n++})}else"number"==typeof a.minWidth&&b.css("min-width",a.minWidth);f(a.title)&&c("<div class='gentleselect-title'>"+a.title+"</div>").prependTo(b);c(document).bind("keyup.gentleselect",k.keyUp);return this},update:function(){var a=this.data("options"),b=this.attr("multiple")?this.val():[this.val()];c("li",this.data("dialog")).each(function(){var a=c(this),e=-1!=c.inArray(a.data("value"),b);a.toggleClass("selected",e)});a=p(this.find(":selected"),
a);this.data("label").text(a);return this}},k={labelHoverIn:function(){c(this).addClass("gentleselect-label-highlight")},labelHoverOut:function(){c(this).removeClass("gentleselect-label-highlight")},labelClick:function(){var a=c(this),b=a.position(),d=a.data("root"),e=d.data("options"),a=d.data("dialog").css("top",b.top+a.height()).css("left",b.left+1);"fade"==e.openEffect?a.fadeIn(e.openSpeed):a.slideDown(e.openSpeed)},dialogHoverOut:function(){var a=c(this);a.data("root").data("options").hideOnMouseOut&&
a.hide()},dialogClick:function(a){var b=c(a.target),d=c(this);a=d.data("root");var e=a.data("options");a.attr("multiple")||("fade"==e.closeEffect?d.fadeOut(e.closeSpeed):d.slideUp(e.closeSpeed));if(b.is("li")&&!b.hasClass("gentleselect-dummy")){var f=b.data("value");b.data("name");var g=d.data("label");d.data("root").attr("multiple")?(b.toggleClass("selected"),b=d.find("li.selected"),g.text(p(b,e)),e=b.map(function(){return c(this).data("value")}),a.val(e.get()).trigger("change")):(d.find("li.selected").removeClass("selected"),
b.addClass("selected"),g.text(b.data("name")),a.val(f).trigger("change"))}},keyUp:function(a){27==a.keyCode&&c(".gentleselect-dialog").hide()}};c.fn.gentleSelect=function(a){if(g[a])return g[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)c.error("Method "+a+" does not exist on jQuery.gentleSelect");else return g.init.apply(this,arguments)}})(jQuery_1_4_1);